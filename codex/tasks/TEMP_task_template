# ğŸ§  Codex TEMP Task Template (v2)

Use this template when defining any TEMP-class task to run through Codex. It ensures clarity, containment, and coherence across system layers.

---

## ğŸ“„ Task Title

*Example: Add Output Format Support to Agent Responses*

---

## ğŸ¯ Goal

Summarize what this task should accomplish and why it matters.

* What are we changing?
* What problem or need does this solve?
* Whatâ€™s the desired outcome?

---

## ğŸ“‚ Scope Definition Grid

Define what this task should touch â€” and what it should avoid:

| Layer        | In Scope | Out of Scope |
| ------------ | -------- | ------------ |
| Backend      |          |              |
| DB Schema    |          |              |
| Frontend     |          |              |
| Webhooks/API |          |              |

---

## ğŸŒŠ Ripple Tracker

Mark the expected downstream effects of the change:

* [ ] DB schema â†’ API output
* [ ] API â†’ Supabase insert
* [ ] Supabase â†’ UI rendering
* [ ] Format support â†’ fallback logic

---

## ğŸ§± Data Contract / Schema Changes

Clearly show the **before** and **after** of the data shape:

```ts
// Before
interface AgentOutput {
  body: string;
}

// After
interface AgentOutput {
  body: string;
  format: 'markdown' | 'json';
  version: string;
}
```

Also include:

* Expected DB table DDL diff (if applicable)
* JSON examples before/after

---

## ğŸ” Cross-System Considerations

Mention anything that must be kept in sync:

* TS types â†” DB schema
* API responses â†” webhook contracts
* Agent logic â†” frontend display

---

## ğŸ“ Codex Context Bundle

Ensure the following are present in `codex/context/<task-name>/`:

* [ ] `current_schema.sql` or `ddl.md`
* [ ] `sample_output_before.json`
* [ ] `target_output_after.json`
* [ ] `interface.ts`
* [ ] `flow_map.md`

---

## ğŸ›¡ï¸ Guardrails & Constraints

* [ ] Do not break existing webhook payloads
* [ ] Must be backward compatible with v1 output
* [ ] Only write to `feat/<task-title>` branch

---

## ğŸ§ª Test & Validate

Codex should provide or trigger tests for:

* [ ] Agent output shape validation
* [ ] Supabase insert success
* [ ] Frontend fallback for unsupported formats
* [ ] CLI or unit tests (if applicable)

---

## ğŸ“œ Codex Session Logging

Log decisions, diffs, and assumptions in:
`codex/sessions/<task-name>.md`

---

Paste this full prompt into Codex only **after** completing the Preflight Checklist.
